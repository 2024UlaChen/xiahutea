<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>夏虎茶</title>
    
    <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.png"/>
    <link
            href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i,600,600i,700,700i&display=swap"
            rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <link rel="stylesheet" href="assets/css/jquery-ui.css">
    <link rel="stylesheet" href="assets/css/slick.css">
    <link rel="stylesheet" href="assets/css/chosen.min.css">
    <link rel="stylesheet" href="assets/css/pe-icon-7-stroke.css">
    <link rel="stylesheet" href="assets/css/magnific-popup.min.css">
    <link rel="stylesheet" href="assets/css/lightbox.min.css">
    <link rel="stylesheet" href="assets/js/fancybox/source/jquery.fancybox.css">
    <link rel="stylesheet" href="assets/css/jquery.scrollbar.min.css">
    <link rel="stylesheet" href="assets/css/mobile-menu.css">
    <link rel="stylesheet" href="assets/fonts/flaticon/flaticon.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="css/general.css">
    <link rel="stylesheet" href="css/member.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link
    href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i,600,600i,700,700i&display=swap"
    rel="stylesheet"
  />
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    />
  <link
    href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="css/homePage.css">
  
</head>
<body>
  <header class="header style2">
    <div class="top-bar">
      <div class="container">
        <div class="row">
          
            <div class="col-lg-3">
              <div class="header-message">
                  <h1>
                      <a href="homePage.html" id="searchHome">夏虎茶</a>
                  </h1>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="query-bar">
                <a href="#" id="forSearchStore">
                  <i class="fa fa-search" aria-hidden="true"></i>
                </a>
                <input type="text" placeholder="搜尋品牌、門市或商品" name="" id="user-enter-keyword">
                <a href="#">
                  <span>
                    <i class="fa fa-times" aria-hidden="true" id="clearSearch"></i>
                  </span>
                </a>
              </div>
            </div>
            <div class="col-lg-3">
              <ul class="header-user-links top-bar-right">
                <li>
                  <a href="orderList.html">
                    <span>
                      <i class="fa fa-book" aria-hidden="true"></i>
                    </span>
                  </a>
                </li>
                <li>
                  <a href="cartDetail.html">
                    <span>
                      <i class="fa fa-shopping-cart" aria-hidden="true"></i>
                    </span>
                  </a>
                </li>

                <li class="teamo-dropdown block-account">
                  <a href="#" data-teamo="teamo-dropdown">
                    <span>
                      <i class="fa fa-user-circle" aria-hidden="true"></i>
                    </span>
                  </a>
                  <ul class="teamo-submenu" id="query-member">
                    <li class="switcher-option">
                      <div class="account-list row">
                        <div class="col-lg-12 no-padding">
                          <div class="col-sm-4">
                            <img src="" alt="" class="userPhoto" id="userLogo">
                          </div>
                          <div class="col-lg-8">
                            <span id="userName">userName</span>

                          </div>
                        </div>
                      </div>
                    </li>
                    <li class="switcher-option">
                      <a href="member.html">
                        <span> 帳號設定 </span>
                      </a>
                    </li>
                    <li class="switcher-option">
                      <a href="loyaltyCard.html">
                        <span> 會員卡 </span>
                      </a>
                    </li>
                    <li class="switcher-option">
                      <a href="coupon.html">
                        <span> 優惠券 </span>
                      </a>
                    </li>
                    <hr>
                    <li class="switcher-option">
                      <a href="orderList.html">
                        <span> 訂單管理 </span>
                      </a>
                    </li>

                    <li class="switcher-option">
                      <a href="faq.html">
                        <span> 常見問題 </span>
                      </a>
                    </li>
                    <hr>
                    <li class="switcher-option">
                      <a id="logOut">
                        <span > 登出 </span>
                      </a>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>
          
        </div>
      </div>
    </div>
  </header>
    
    
    <div class="Container m-5">
        <h3 style="font-weight: 800;">集點卡專區</h3>
        <div class="row KunSpeedSearch">
            <div class="col-8">
            <a href="homePage.html" style="text-underline-offset:5px;">回首頁</a>
            </div>
            

        </div>
        <div class="container px-4 py-5" id="custom-cards">
        
            <div class="row row-cols-1 row-cols-lg-3 align-items-stretch g-4 py-5" id="loyaltyCards">




            </div>
          </div>
            






    
        <div class="row align-items-md-stretch">
        
                <div class="col-md-6">
                    <div class="h-100 p-5 text-secondary  bg-dark rounded-3">
                        <h2 style="color: whitesmoke">有夏虎茶真好，快來瞭解我們吧</h2>
                        
                        <a href="faq.html" class="btn btn-outline-light" type="button">快速上手</a>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="h-100 p-5 bg-light border rounded-3">
                        <h2>有夏虎茶真好，快來加入我們吧</h2>
                        
                        <a href="joinUs.html" class="btn btn-outline-secondary" type="button">手刀報名</a>
                    </div>
                </div>
        </div> <!--招商-->
    </div>
<!-- 頁腳 -->
<footer class="footer style7">
  <div class="container">
      <div class="container-wapper no-padding">
          <div class="row">
              <div class="box-footer col-xs-12 col-sm-4 col-md-4 col-lg-4">
                  <div class="teamo-custommenu default">
                      <ul class="menu">
                          <li class="menu-item">
                              <h3>夏虎茶</h3>
                          </li>
                          <li class="menu-item">
                              <span >公司資訊：雲仲資訊股份有限公司</span>
                          </li>
                          <li class="menu-item">
                              <span >統一編號：58364751
                              </span>
                          </li>
                      </ul>
                  </div>
              </div>
              <div class="box-footer col-xs-12 col-sm-4 col-md-4 col-lg-4 hidden-xs">

              </div>
              <div class="box-footer col-xs-12 col-sm-4 col-md-4 col-lg-4">
                  <div class="teamo-custommenu default">
                      <ul class="menu">
                          <li class="menu-item">
                              <a href="faq.html">常見問題</a>
                          </li>
                          <li class="menu-item">
                              <a href="privacyRule.html">隱私權條款</a>
                          </li>

                          <li class="menu-item">
                              <a href="userRule.html">使用者條款</a>
                          </li>
                          <li class="menu-item">
                              <a href="creditCardRule.html">信用卡條款</a>
                          </li>
                      </ul>
                  </div>
              </div>
          </div>
          <div class="footer-end">
              <div class="row">
                  <div class="col-sm-12 col-xs-12">

                      <div class="coppyright">
                          © 2024 XiaHuTea 台灣 . All rights reserved
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
</footer>

<script src="assets/js/jquery-1.12.4.min.js"></script>
<script src="assets/js/jquery.plugin-countdown.min.js"></script>
<script src="assets/js/jquery-countdown.min.js"></script>
  <script src="cms/plugins/sweetalert2/sweetalert2.all.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/owl.carousel.min.js"></script>
<script src="assets/js/magnific-popup.min.js"></script>
<script src="assets/js/isotope.min.js"></script>
<script src="assets/js/jquery.scrollbar.min.js"></script>
<script src="assets/js/jquery-ui.min.js"></script>
<script src="assets/js/mobile-menu.js"></script>
<script src="assets/js/chosen.min.js"></script>
<script src="assets/js/slick.js"></script>
<script src="assets/js/jquery.elevateZoom.min.js"></script>
<script src="assets/js/jquery.actual.min.js"></script>
<script src="assets/js/fancybox/source/jquery.fancybox.js"></script>
<script src="assets/js/lightbox.min.js"></script>
<script src="assets/js/owl.thumbs.min.js"></script>
<script src="assets/js/jquery.scrollbar.min.js"></script>
<script src='https://maps.googleapis.com/maps/api/js?key=AIzaSyC3nDHy1dARR-Pa_2jjPCjvsOR4bcILYsM'></script>
<script src="assets/js/frontend-plugin.js"></script>
  <script src="js/homePageMember.js"></script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded",function(){
            getUser();
            SearchBar();
            clearSearchBar();
              $.ajax({
                  url:'/member/loyalty/info',
                  dataType:'json',
                  method:'GET',
                  contentType:'application/json',
                  success:function (list){
                      //$('#loyaltyCards').empty();
                      list.forEach(function (row){
                          let base64Img = row.store.logo;
                          let imgformat = getBase64Img(base64Img);
                          let passday = row.store.expiredDate;
                          if(row.store.validStatus){
                              passday = '激活中';
                          }

                          let str =`
                          <div class="col" data-bs-toggle="modal" data-bs-target="#exampleModal${row.loyaltyCardId}">
                <div class="card card-cover h-100 overflow-hidden text-white bg-dark rounded-5 shadow-lg Kuncard"
                style="background-image: url('data:image/${imgformat};base64,${base64Img}'); background-size: cover; background-position: center;">
                  <div class="d-flex flex-column h-100 p-5 pb-3 text-white text-shadow-1">
                    <h4 class="display-8 pb-5 mb-5 lh-1 " style="color: black;">${row.store.storeName}</h4>
                    <ul class="d-flex list-unstyled mt-auto">
                      <li class="me-auto">
                        <img src="https://github.com/twbs.png" alt="Bootstrap" width="32" height="32" class="rounded-circle border border-white">
                      </li>
                      <li class="d-flex align-items-center me-3">
                        <svg class="bi me-2" width="1em" height="1em"><use xlink:href="#geo-fill"></use></svg>
                        <small class="text-dark">效期:${passday}</small>
                      </li>
                      <li class="d-flex align-items-center">
                        <svg class="bi me-2" width="1em" height="1em"><use xlink:href="#calendar3"></use></svg>
                        <small class="text-dark">點數:${row.points}</small>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>

              <!-- Modal -->
                <div
        class="modal fade "
        id="exampleModal${row.loyaltyCardId}"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">會員卡說明</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <p>點數十點可折抵五十元</p>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                關閉
              </button>

            </div>
          </div>
        </div>
      </div>
                          `;
                          document.querySelector('#loyaltyCards').insertAdjacentHTML('afterbegin',str);
                      });
                  }
              });
              logOutSkip();

        }); //end dom

    </script>

<script>
    function getBase64Img(base64Img){
        if(base64Img !=null){
            let imgFormat;
            if (base64Img.startsWith("iVBORw0KGgo")) {
                imgFormat = "png"; // PNG 圖片的 base64 開頭
            } else if (base64Img.startsWith("/9j/")) {
                imgFormat = "jpeg"; // JPEG 圖片的 base64 開頭
            }else if (base64Img.startsWith("R0lGODlh")) {
                imgFormat = "gif"; // JPEG 圖片的 base64 開頭
            }else if (base64Img.startsWith("Qk0")) {
                imgFormat = "bmp"; // JPEG 圖片的 base64 開頭
            }else if (base64Img.startsWith("UklGR")) {
                imgFormat = "webp"; // JPEG 圖片的 base64 開頭
            }else if (base64Img.startsWith("PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmci")) {
                imgFormat = "svg+xml"; // JPEG 圖片的 base64 開頭
            }
            else {
                console.error("不支持的圖片格式");
            }
            return imgFormat;
        }

    }
</script>
</body>
</html>