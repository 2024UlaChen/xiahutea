<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Log in</title>

    <!-- Google Font: Source Sans Pro -->
    <!--    <link rel="stylesheet"-->
    <!--          href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">-->
<!--     Font Awesome -->
    <!--    <link rel="stylesheet" href="dist/css/all.min.css">-->
<!--     icheck bootstrap -->
    <!--    <link rel="stylesheet" href="plugins/icheck-bootstrap/icheck-bootstrap.min.css">-->

    <link rel="stylesheet" href="dist/css/adminlte.min.css">

    <style>
        .btn-group {
            display: flex;
            margin-bottom: 10px;
            opacity: .3;
        }

        #result {
            margin: 0px 5px 5px 5px;
            color: red;
        }

    </style>
</head>
<body class="hold-transition login-page">
<div class="login-box">
    <!-- /.login-logo -->
    <div class="card card-outline card-primary">
        <div class="card-header text-center">
            <a href="#" class="h1"><b>XIAHUTEA</b> 後台</a>
        </div>
        <div class="card-body">
            <p class="login-box-msg">Sign in to start your session</p>
            <div class="btn-group btn-group-toggle" data-toggle="buttons">

                <label class="btn bg-white active" id="store-login">
                    <input type="radio" name="options" autocomplete="off" checked> 店家登入
                </label>
                <label class="btn bg-white" id="administrator-login">
                    <input type="radio" name="options" autocomplete="off"> 管理員登入
                </label>
            </div>

            <div class="input-group mb-3">
                <input type="text" id="username" class="form-control" placeholder="用戶名稱">
            </div>
            <div class="input-group mb-3">
                <input type="password" id="password" class="form-control" placeholder="用戶密碼">
            </div>
            <hr>
            <div>
                <label id="result"></label>
            </div>
                <div class="row">
                    <div class="col-8">
                        <div class="icheck-primary">
                            <input type="checkbox" id="remember">
                            <label for="remember">
                                Remember Me
                            </label>
                        </div>
                    </div>
                    <!-- /.col -->
                    <div class="col-4">
                        <button type="submit" class="btn btn-info btn-block">登入</button>
                    </div>
                    <!-- /.col -->
                </div>

        </div>
        <!-- /.card-body -->
    </div>
    <!-- /.card -->
</div>

<!-- jQuery -->
<script src="./plugins/jquery/jquery.min.js"></script>

<!-- Bootstrap 4 -->
<script src="./plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- AdminLTE App -->
<script src="./dist/js/adminlte.min.js"></script>

<script>
    let usernameInput = $("input#username")
    let passwordInput = $("input#password")

    $("button").on("click", () => {
        let username = $(usernameInput).val();
        let password = $(passwordInput).val();
        let storeFlag = $("#store-login").hasClass("active");
        if (!storeFlag) {
            fetch("/admin/login", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    adminUsername: username,
                    adminPassword: password
                })
            }).then(res => res.json()).then(admin => {
                if (admin.successful) {
                    location = "./storeIndex.html"
                } else {
                    let message = admin.message
                    $("#result").text(message);
                    console.log(message);
                }
            })
        } else {
            console.log("store")
        }

        // console.log(username, password)
    })

</script>

</body>
</html>
