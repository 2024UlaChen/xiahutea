<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>faq</title>

    <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.png"/>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i,600,600i,700,700i&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <link rel="stylesheet" href="assets/css/jquery-ui.css">
    <link rel="stylesheet" href="assets/css/slick.css">
    <link rel="stylesheet" href="assets/css/chosen.min.css">
    <link rel="stylesheet" href="assets/css/pe-icon-7-stroke.css">
    <link rel="stylesheet" href="assets/css/magnific-popup.min.css">
    <link rel="stylesheet" href="assets/css/lightbox.min.css">
    <link rel="stylesheet" href="assets/js/fancybox/source/jquery.fancybox.css">
    <link rel="stylesheet" href="assets/css/jquery.scrollbar.min.css">
    <link rel="stylesheet" href="assets/css/mobile-menu.css">
    <link rel="stylesheet" href="assets/fonts/flaticon/flaticon.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="css/general.css">
    <link rel="stylesheet" href="css/faq.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="css/weien-chat.css">
</head>

<body>
<div class="header"></div>
<div class="main-content main-content-contact">
    <div class="page-main-content">
        <div id="faq">
            <div class="row">
                <div class="col-lg-12">
                    <div class="form-contact reset-margin row">

                        <div class="col-lg-3" id="faq-nav">
                            <div id="faq-query-bar">
                                <input id="faq-input" type="text" placeholder="搜尋問題關鍵字">
                                <a href="#" id="search">
                                    <i class="fa fa-search" aria-hidden="true"></i>
                                </a>
                            </div>
                            <div id="title-list">
                                <ul >
                                    <li>
                                        <a href="#faq-card-1">新手上路</a>
                                    </li>
                                    <li>
                                        <a href="#faq-card-2">會員資訊</a>
                                    </li>
                                    <li>
                                        <a href="#faq-card-3">訂購資訊</a>
                                    </li>
                                    <li>
                                        <a href="#faq-card-4">優惠券與集點卡</a>
                                    </li>
                                    <li>
                                        <a href="#faq-card-5">其他問題</a>
                                    </li>
                                </ul>
                            </div>

                        </div>
                        <div class="col-lg-9" id="card-list">
                            <div class="faq-card" id = faq-card-1>
                                <div class="card-title">
                                    新手上路
                                </div>
                                <ul class="faq-list">
                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 訂餐流程 ] 如何使用夏虎茶訂餐？</span>
                                        </a>

                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci aperiam
                                            consectetur debitis deserunt dolores eaque eius, est fugiat impedit ipsam
                                            itaque non obcaecati praesentium quo reprehenderit sunt suscipit veniam
                                            vero.
                                        </div>

                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 取餐資訊 ] 門市的營業時間/電話/地址/外送限制/取餐方式/支付方式/金額上限</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ad adipisci
                                            commodi eveniet exercitationem illum libero modi nostrum saepe tempore
                                            temporibus. Atque consequatur ducimus enim ex id porro, quam rerum soluta!
                                        </div>
                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 優惠券 ] 如何使用優惠券享有折扣？</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ad adipisci
                                            commodi eveniet exercitationem illum libero modi nostrum saepe tempore
                                            temporibus. Atque consequatur ducimus enim ex id porro, quam rerum soluta!
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <div class="faq-card" id = faq-card-2>
                                <div class="card-title">
                                    會員資訊
                                </div>
                                <ul class="faq-list">
                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 忘記密碼 ] 忘記密碼無法登入怎麼辦?</span>
                                        </a>

                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci aperiam
                                            consectetur debitis deserunt dolores eaque eius, est fugiat impedit ipsam
                                            itaque non obcaecati praesentium quo reprehenderit sunt suscipit veniam
                                            vero.
                                        </div>

                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 通知設定 ] 我要怎麼收到通知(訂單、點數和優惠券期限)</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ad adipisci
                                            commodi eveniet exercitationem illum libero modi nostrum saepe tempore
                                            temporibus. Atque consequatur ducimus enim ex id porro, quam rerum soluta!
                                        </div>
                                    </li>
                                </ul>

                            </div>
                            <div class="faq-card" id = faq-card-3>
                                <div class="card-title">
                                    訂購資訊
                                </div>
                                <ul class="faq-list">
                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 取餐方式 ] 門市是否支援外送服務？</span>
                                        </a>

                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci aperiam
                                            consectetur debitis deserunt dolores eaque eius, est fugiat impedit ipsam
                                            itaque non obcaecati praesentium quo reprehenderit sunt suscipit veniam
                                            vero.
                                        </div>

                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 訂購資訊 ] 收到的商品品項有誤</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci aperiam
                                            consectetur debitis deserunt dolores eaque eius, est fugiat impedit ipsam
                                            itaque non obcaecati praesentium quo reprehenderit sunt suscipit veniam
                                            vero.
                                        </div>
                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 訂購資訊 ] 登入找不到訂單</span>
                                        </a>
                                        <div class="inner_block">
                                            請確認下訂時與現在是否為相同帳號 (相同入徑登入)。
                                        </div>
                                    </li>
                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 付款資訊 ] 申請退款後，多久會收到退款呢？</span>
                                        </a>

                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci aperiam
                                            consectetur debitis deserunt dolores eaque eius, est fugiat impedit ipsam
                                            itaque non obcaecati praesentium quo reprehenderit sunt suscipit veniam
                                            vero.
                                        </div>

                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button type="button" class="switch_btn">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 發票開立 ] 有打統編的公司發票存入個人載具，該怎麼查詢/列印？</span>
                                        </a>
                                        <div class="inner_block">
                                            1. 須請公司會計單位使用“公司帳號“登入，選擇「營業人」進入「財政部電子發票整合服務平台」查詢/列印。<br>
                                            2. 使用“個人帳號“登入財政部電子發票整合服務平台的話，僅能看到簡易明細，無法下載正式的電子發票證明。<br>
                                            3. <a href="https://www.mof.gov.tw/singlehtml/155?cntId=84135"
                                                  target="_blank">財政部電子發票整合服務平台官方資訊參考</a>
                                        </div>
                                    </li>
                                </ul>

                            </div>
                            <div class="faq-card" id = faq-card-4>
                                <div class="card-title">
                                    優惠券與集點卡
                                </div>
                                <ul class="faq-list">
                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 優惠券 ] 如何取得優惠券？</span>
                                        </a>

                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci aperiam
                                            consectetur debitis deserunt dolores eaque eius, est fugiat impedit ipsam
                                            itaque non obcaecati praesentium quo reprehenderit sunt suscipit veniam
                                            vero.
                                        </div>

                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 優惠券 ] 我該如何知道優惠券規則？</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Amet corporis enim
                                            eum exercitationem facilis laudantium maxime mollitia, natus nemo, pariatur
                                            sint suscipit, tempora temporibus ullam velit! Ab amet ex nihil!
                                        </div>
                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 優惠券 ] 如何使用優惠券?</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ad adipisci
                                            commodi eveniet exercitationem illum libero modi nostrum saepe tempore
                                            temporibus. Atque consequatur ducimus enim ex id porro, quam rerum soluta!
                                        </div>
                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 優惠券 ] 如何知道我的券夾裡有什麼優惠券以及優惠券使用期限呢？</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ab accusamus
                                            architecto asperiores consectetur cum delectus dolorum earum facere in
                                            minima necessitatibus obcaecati pariatur porro provident quae quis suscipit
                                            unde, ut.
                                        </div>
                                    </li>
                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 集點卡 ] 如何獲得店家集點卡？</span>
                                        </a>

                                        <div class="inner_block">
                                            購買該店家商品即可獲得店家集點卡
                                        </div>

                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 集點卡 ] 我該如何知道店家的集點卡規則？</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. A accusamus alias
                                            aliquid commodi consectetur doloribus error esse eveniet inventore, ipsum
                                            laboriosam mollitia natus nobis quasi rerum sapiente sunt. Omnis, sapiente!
                                        </div>
                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 集點卡 ] 如何進行點數兌換?</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. A consectetur
                                            cumque fugiat magnam quas repellat? Autem consequatur deleniti dolorum error
                                            exercitationem fugit minima obcaecati, officiis optio quasi sapiente
                                            voluptates voluptatum!
                                        </div>
                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 集點卡 ] 如何知道我的有哪些集點卡與集點卡使用期限</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Alias in ipsa nisi
                                            nulla reiciendis saepe sed voluptates! Ad animi aspernatur atque consectetur
                                            cumque mollitia rem totam? A aspernatur dicta unde!
                                        </div>
                                    </li>
                                </ul>

                            </div>
                            <div class="faq-card" id = faq-card-5>
                                <div class="card-title">
                                    其他問題
                                </div>
                                <ul class="faq-list">
                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 系統異常 ] 點擊按鈕無反應</span>
                                        </a>

                                        <div class="inner_block">
                                            1. 請確認是否使用 Chrome, Safari, Firefox 瀏覽器，以及是否為正常狀態
                                            (非私密瀏覽、非無痕視窗)<br>
                                            2. 請確認網路訊號狀態，是否有設定任何阻擋<br>
                                            3. 請確認是否有關閉cookie存取的設定<br>
                                            4. 可嘗試重新整理頁面<br>
                                            5. 請向夏虎茶客服反應<br>
                                        </div>

                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 定位問題 ] 怎麼開啟定位呢？</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Asperiores
                                            consequatur enim labore laborum nostrum officia perferendis tempore.
                                            Cupiditate dolorem ducimus facilis harum incidunt inventore ipsa minima
                                            necessitatibus, omnis similique tempore?
                                        </div>
                                    </li>

                                    <li>
                                        <a class="link_title" href="#">
                                            <button class="switch_btn" type="button">
                                                <span class="-plus">+</span>
                                                <span class="-minus">-</span>
                                            </button>
                                            <span>[ 門市募集 ] 我是店家，想加入(了解)夏虎茶</span>
                                        </a>
                                        <div class="inner_block">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ad adipisci
                                            commodi eveniet exercitationem illum libero modi nostrum saepe tempore
                                            temporibus. Atque consequatur ducimus enim ex id porro, quam rerum soluta!
                                        </div>
                                    </li>
                                </ul>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="chat-room">

        <div class="chat-container">
            <div id="weien-chat"></div>
        </div>
        <div id="chat-icon" class=".d-none">
            <b class="bi bi-chat-dots"></b>
        </div>

    </div>
</div>
<div class="footer"></div>


<script src="assets/js/jquery-1.12.4.min.js"></script>
<script src="assets/js/jquery.plugin-countdown.min.js"></script>
<script src="assets/js/jquery-countdown.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/owl.carousel.min.js"></script>
<script src="assets/js/magnific-popup.min.js"></script>
<script src="assets/js/isotope.min.js"></script>
<script src="assets/js/jquery.scrollbar.min.js"></script>
<script src="assets/js/jquery-ui.min.js"></script>
<script src="assets/js/mobile-menu.js"></script>
<script src="assets/js/chosen.min.js"></script>
<script src="assets/js/slick.js"></script>
<script src="assets/js/jquery.elevateZoom.min.js"></script>
<script src="assets/js/jquery.actual.min.js"></script>
<script src="assets/js/fancybox/source/jquery.fancybox.js"></script>
<script src="assets/js/lightbox.min.js"></script>
<script src="assets/js/owl.thumbs.min.js"></script>
<script src="assets/js/jquery.scrollbar.min.js"></script>
<script src="assets/js/frontend-plugin.js"></script>
<script src="js/general.js"></script>
<script src="js/faq.js"></script>
<script src="js/weien-chat-box.js"></script>

<script type="module">
    import { actionHandlers, WeienChat } from './js/weien-chat-box.js'
    let userTypeId;
    const url
        =  `ws://${location.host}${location.pathname.substring(0, location.pathname.lastIndexOf('/') + 1)}cms/chat`;

    // 使用前須覆寫actionHandlers中必要的方法
    // 詳細可以去 weien-chat.js 中的 actionHandlers查看
    actionHandlers.getChatRoomsData = async () => {
        return await fetch("/chatroomdata")
            .then(res => res.json())
            .then(data =>{
                return data;
            })
    }

    actionHandlers.getChatMessagesData = async (chatId) => {

        return await fetch(`/chatmessagesdata/${chatId}`)
            .then(res => res.json())
            .then(ChatMessagesData =>{
                return ChatMessagesData;
            })
    }

    actionHandlers.loadMoreChatRooms = async (type) => {
        // console.log(type);
        // type是指現在的過濾模式 (全部, 未讀, 置頂)
        // 目前是傳入假資料
        return chatRoomData;
    }

    actionHandlers.loadMoreMessages = async () => {
        // 目前是傳入假資料
        return messages;
    }

    actionHandlers.getUID = async () => {
        return await fetch("/totalusers")
            .then(res => res.json())
            .then(data => {
                userTypeId = data.userTypeId;
                return data.totalUserId;
            })
        // return 45;
    }

    actionHandlers.sendMessage = (message) => {
        message.timestamp = new Date();
        chat.updateChatListInfo(message.chatId,message);
        chat.appendMessage(message) ;
        if (webSocket) {
            webSocket.send(
                JSON.stringify({
                    chatSessionId: message.chatId,
                    content: message.content,
                    senderId : message.senderId,
                    timestamp : message.timestamp
                })
            )
        }
    }

    const handleSendMessage = e => {
        let payload = JSON.parse(e.data);
        let message = {chatId : payload.chatSessionId,
            content : payload.content,
            senderId : payload.senderId,
            timestamp : payload.timestamp
        }
        let activeChatId = chat.getActiveChatId();      //獲取這個聊天室的id
        chat.updateChatListInfo(message.chatId,message);  //更新聊天室側邊欄聊天室列表
        if(activeChatId === message.chatId){
            chat.appendMessage(message) ;
        }
    }

    const chat = new WeienChat();
    let webSocket;

    $("#chat-icon").on("click",async() => {
        $(".chat-container").toggle();
    })
    document.addEventListener('DOMContentLoaded', async () => {
    //      // 加載完成以後啟動
        await chat.init();
        chat.state.value.showMode = 'mobile'
        let chatRoomsData = await actionHandlers.getChatRoomsData();        //獲取聊天室資料
        let chatSessionId = await chatRoomsData[0].chatId;                        //第一筆聊天室的 chatId
        chat.state.value.activeChatId = chatSessionId;
        webSocket = new WebSocket(url);
        webSocket.addEventListener('message', handleSendMessage);
    //
    });

</script>
</body>


</html>